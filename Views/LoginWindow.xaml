<ui:FluentWindow x:Class="DataGateWin.Views.LoginWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 Title="DataGate OpenVPN 3"
                 Height="440"
                 Width="640"
                 WindowStartupLocation="CenterScreen"
                 ResizeMode="NoResize"
                 WindowBackdropType="Mica"
                 ExtendsContentIntoTitleBar="True">

    <ui:FluentWindow.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </ui:FluentWindow.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Title bar must be flush to window edge -->
        <ui:TitleBar Grid.Row="0"
                     Title="DataGate OpenVPN 3"
                     ShowClose="True"
                     ShowMinimize="True"
                     ShowMaximize="False"/>

        <!-- Content area with padding -->
        <Grid Grid.Row="1" Margin="28">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <ui:Card Grid.Row="0" Padding="28" VerticalAlignment="Center">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,18">
                        <ui:SymbolIcon Symbol="Shield24" FontSize="26" Margin="0,2,12,0"/>
                        <StackPanel>
                            <ui:TextBlock Text="Welcome to DataGate OpenVPN 3"
                                          FontTypography="Title"
                                          FontWeight="SemiBold"/>
                            <ui:TextBlock Text="Sign in to continue"
                                          Opacity="0.75"
                                          Margin="0,4,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Primary -->
                    <ui:Button Grid.Row="1"
                               Height="46"
                               Appearance="Primary"
                               Command="{Binding SignInCommand}"
                               IsEnabled="{Binding IsNotBusy}">
                        <ui:Button.Icon>
                            <ui:SymbolIcon Symbol="PersonAccounts24"/>
                        </ui:Button.Icon>
                        <ui:Button.Content>
                            <TextBlock Text="Sign in with Google"/>
                        </ui:Button.Content>
                    </ui:Button>

                    <!-- Cancel only when busy -->
                    <ui:Button Grid.Row="2"
                               Height="42"
                               Margin="0,10,0,0"
                               Appearance="Secondary"
                               Command="{Binding CancelCommand}"
                               Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}">
                        <ui:Button.Icon>
                            <ui:SymbolIcon Symbol="Dismiss24"/>
                        </ui:Button.Icon>
                        <ui:Button.Content>
                            <TextBlock Text="Cancel"/>
                        </ui:Button.Content>
                    </ui:Button>

                    <!-- Status -->
                    <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,16,0,0">
                        <ui:ProgressRing Width="18"
                                         Height="18"
                                         IsIndeterminate="True"
                                         Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}"/>
                        <ui:TextBlock Text="{Binding StatusText}"
                                      Margin="10,0,0,0"
                                      Opacity="0.85"
                                      TextWrapping="Wrap"/>
                    </StackPanel>
                </Grid>
            </ui:Card>

            <!-- Footer -->
            <ui:TextBlock Grid.Row="1"
                          HorizontalAlignment="Center"
                          Opacity="0.55"
                          Margin="0,18,0,0"
                          Text="A browser window will open for Google authentication."/>
        </Grid>
    </Grid>
</ui:FluentWindow>
